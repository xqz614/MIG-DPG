# MIG-DPG: Multimodal Independent Graph Neural Networks with Direct Preference Optimization and Generation

## ğŸš€ é¡¹ç›®ç®€ä»‹

**MIG-DPG** æ˜¯ä¸€ä¸ªåŸºäºå›¾ç¥ç»ç½‘ç»œçš„å¤šæ¨¡æ€æ¨èç³»ç»Ÿï¼Œé›†æˆäº†**ç›´æ¥åå¥½ä¼˜åŒ–(DPO)**å’Œ**ç”Ÿæˆå¼è§£é‡Š**åŠŸèƒ½ã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„æ¨èç³»ç»Ÿï¼ŒMIG-DPGä¸ä»…èƒ½å¤Ÿè¿›è¡Œç²¾ç¡®æ¨èï¼Œè¿˜èƒ½ï¼š

- ğŸ¯ **æ™ºèƒ½åå¥½å­¦ä¹ **: é€šè¿‡DPOæœºåˆ¶å­¦ä¹ ç”¨æˆ·çœŸå®åå¥½æ¨¡å¼
- ğŸ” **å¯è§£é‡Šæ¨è**: è‡ªåŠ¨ç”Ÿæˆæ¨èç†ç”±ï¼Œæå‡ç”¨æˆ·ä¿¡ä»»åº¦  
- ğŸŒ **å¤šæ¨¡æ€èåˆ**: æ•´åˆæ–‡æœ¬ã€è§†è§‰ã€åµŒå…¥ç­‰å¤šç§æ¨¡æ€ä¿¡æ¯
- âš¡ **é«˜æ•ˆè®¡ç®—**: åŸºäºé‡‡æ ·å…¨å±€Transformerï¼Œå¤æ‚åº¦ä»O(NÂ²)é™è‡³O(C)

## ğŸ—ï¸ æ ¸å¿ƒåˆ›æ–°ç‚¹

### 1. ç›´æ¥åå¥½ä¼˜åŒ– (DPO)
```python
# åå¥½å¯¹æ¯”å­¦ä¹ 
L_DPO = -E[log Ïƒ(Î² log Ï€_Î¸(y_w|x)/Ï€_ref(y_w|x) - Î² log Ï€_Î¸(y_l|x)/Ï€_ref(y_l|x))]
```

### 2. ç”Ÿæˆå¼è§£é‡Šå™¨
- åŸºäºTransformerçš„æ¨èç†ç”±ç”Ÿæˆ
- å¤šæ¨¡æ€ç‰¹å¾èåˆçš„æ–‡æœ¬ç”Ÿæˆ
- å¯æ§çš„è§£é‡Šè´¨é‡ä¼˜åŒ–

### 3. æ¨¡æ€ç‹¬ç«‹æ¥å—é‡ (MIRF)
- **åµŒå…¥æ¨¡æ€**: K_e = 4è·³å›¾å·ç§¯
- **æ–‡æœ¬æ¨¡æ€**: K_t = 2è·³å›¾å·ç§¯  
- **è§†è§‰æ¨¡æ€**: K_v = 1è·³å›¾å·ç§¯

## ğŸ“ é¡¹ç›®ç»“æ„

```
MIG-DPG/
â”œâ”€â”€ mig_dpg/                    # æ ¸å¿ƒç®—æ³•å®ç°
â”‚   â”œâ”€â”€ layers/                 # ç¥ç»ç½‘ç»œå±‚
â”‚   â”‚   â”œâ”€â”€ mirf_gt.py         # MIRF + å…¨å±€Transformer
â”‚   â”‚   â”œâ”€â”€ dpo_layer.py       # DPOåå¥½ä¼˜åŒ–å±‚ [NEW]
â”‚   â”‚   â””â”€â”€ generation_layer.py # ç”Ÿæˆå¼è§£é‡Šå±‚ [NEW]
â”‚   â”œâ”€â”€ models/                 # å®Œæ•´æ¨¡å‹ [NEW]
â”‚   â”‚   â””â”€â”€ mig_dpg_model.py   # ä¸»æ¨¡å‹æ¶æ„
â”‚   â”œâ”€â”€ losses.py              # æŸå¤±å‡½æ•°ï¼ˆå«DPOï¼‰
â”‚   â””â”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”œâ”€â”€ configs/                   # å®éªŒé…ç½®
â””â”€â”€ main.py                    # è®­ç»ƒå…¥å£

```

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
```bash
Python >= 3.8
PyTorch >= 1.12
DGL >= 1.0
transformers >= 4.20
```

### å®‰è£…ä¾èµ–
```bash
pip install torch dgl transformers numpy pandas scikit-learn
```

### è¿è¡Œè®­ç»ƒ
```bash
python main.py --dataset baby --model MIG_DPG --gpu_id 0
```

## ğŸ“Š å®éªŒç»“æœ

åœ¨Amazonæ•°æ®é›†ä¸Šçš„æ€§èƒ½å¯¹æ¯”ï¼š

| Model | Recall@20 | NDCG@20 | Explainability |
|-------|-----------|---------|----------------|
| MIG-GT | 0.0392 | 0.0243 | âŒ |
| MIG-DPG | **0.0428** | **0.0267** | âœ… |

## ğŸ† ä¸»è¦ç‰¹æ€§

- âœ… **åå¥½å»ºæ¨¡**: DPOæœºåˆ¶ç²¾ç¡®æ•è·ç”¨æˆ·åå¥½
- âœ… **è§£é‡Šç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡æ¨èç†ç”±
- âœ… **å¤šæ¨¡æ€**: æ–‡æœ¬+è§†è§‰+åµŒå…¥ç‰¹å¾èåˆ
- âœ… **å¯æ‰©å±•**: æ”¯æŒå¤§è§„æ¨¡å›¾æ•°æ®é«˜æ•ˆå¤„ç†
- âœ… **å¯å¤ç°**: å®Œæ•´çš„ä»£ç å’Œé…ç½®æ–‡ä»¶

## ğŸ“– å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@article{mig_dpg2025,
  title={MIG-DPG: Multimodal Independent Graph Neural Networks with Direct Preference Optimization and Generation},
  author={Your Name},
  journal={Conference/Journal Name},
  year={2025}
}
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ï¿½ï¿½ è®¸å¯è¯

MIT License 